angular.module("divshot.support",[]).directive("dsSupportLink",function(){return{restrict:"A",scope:{dsTitle:"@",dsBtnLabel:"@",dsCancelCallback:"&",dsSubmitCallback:"&"},controller:function(a,b){return a.modalTemplate='<div class="modal-header">\n  <h2>{{dsTitle}}</h2>\n  <a class="cancel" ng-click="close()">&times;</a>\n</div>\n<div class="modal-epicenter">\n  <div ng-if="showErrorMessage"><p class="error">{{errorMessage}}</p></div>\n  <form name="supportModalForm" role="form">\n    <div class="form-group">\n      <input type="text" ng-model="$parent.subject" class="form-control" id="subject" placeholder="Subject">\n    </div>\n    <div class="form-group">\n      <textarea ng-model="$parent.body" class="form-control" id="body" placeholder="Message" rows="5"></textarea>\n    </div>\n    <p class="help-block">Want to chat? Our devs hang out in #divshot on freenode.</p>\n  </form>\n</div>\n<div class="modal-footer">\n  <button type="submit" class="btn btn-primary" ng-click="submit()">{{dsBtnLabel}}</button> \n</div>',a.render=function(){var c;return b.has("$modal")?(c=b.get("$modal"),c.open({scope:a,template:this.modalTemplate,windowClass:"support-modal",controller:function(a,b,c){var d;return a.errorMessage="Please provide a valid subject and message.",b.has("divshot")?(d=b.get("divshot"),a.submit=function(){var e;return a.subject&&a.body?d.user.sendHelpRequest(a.subject,a.body).then(function(){return c.close()}):b.has("$notification")?(e=b.get("$notification"),e.error(a.errorMessage)):a.showErrorMessage=!0},a.close=function(){return c.dismiss("cancel")}):void console.error('dsSupportModal directive requires "divshot-api": https://github.com/divshot/divshot-api')}}).result.then(function(){return a.dsSubmitCallback()},function(){return a.dsCancelCallback()})):void console.error('dsSupportModal directive requires "angular-bootstrap": https://github.com/angular-ui/bootstrap')}},link:function(a,b){var c;return c=function(){return a.render()},b.on("click",c)}}});